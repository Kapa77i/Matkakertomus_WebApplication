@page "/locations"

@using System.Threading.Tasks
@using System.Net.Http
@using System.Net.Http.Json

@inject NavigationManager NavigationManager
@inject ILogger<Index> Logger
@inject HttpClient Http

<h1>Matkakohteet</h1>

@*voi lisätä, poistaa, päivittää ja selata matkakohteita.
Sellaista matkakohdetta, johon liittyy joku matkakertomus, ei saa poistaa tai päivittää

Kuka tahansa ei voi tehdä CRUD toimintoja, vaan siihen pitää vaatia login.
Kuka tahansa voi selata ja hakea matkakohteita*@

@*Tästä sivusta tulee tavallaan matkakohteiden index sivu?
    Tältä sivulta voidaan hakea ja selata matkakohteita. 
    Tee: 
        -ylös hakupalkki: voi hakea/suodattaa matkakohteen nimellä?
        -sivu näyttää matkakohteet (2-3 sarakkeisessa taulukossa?)
        -matkakohdetta klikkaamalla näkee mahdolliset tarinat?? -> takaisin -nappi 
        -matkakohteiden muokkaus vain jos olet sisäänkirjautuneena?

        sis. idmatkakohde, kohdenimi, maa, paikkakunta, kuvausteksti, kuva (id:tä ei tarvitse näyttää, ellei muokata tai poisteta)
*@

@if(locations != null){

    <ul>
        @foreach(var l in locations){
            <li>
                <div>
                    <div>@l.kuva</div>
                    <div><h3>@l.kohdenimi</h3></div>
                    <div><h4>@l.maa</h4></div>
                    <div><h5>@l.paikkakunta</h5></div>
                    <div>@l.kuvausteksti</div>
                </div>
            </li>
        }
    </ul>
}
@code {
    List<SharedLib.matkakohdeDTO>? locations = new List<SharedLib.matkakohdeDTO>();

    protected override async Task OnInitializedAsync(){

        var data = await Http.GetAsync("api/Matkakohdes");
        locations = await data.Content.ReadFromJsonAsync<List<SharedLib.matkakohdeDTO>>();
    }
}
